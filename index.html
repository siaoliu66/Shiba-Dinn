<!DOCTYPE html>
<html lang="zh-TW">

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shiba-Dinn</title>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://unpkg.com/vue@2"></script>
    <link rel="stylesheet" href="css/calculator.css">
    <script src="js/calculator.js"></script>
  </head>

  <body>
    <div class="wrap">
      <div class="header">
        <img src="https://github.com/siaoliu66/Shiba-Dinn/blob/gh-pages/image/logo.png?raw=true" alt="">
      </div>
      <div class="container">
        <label for="price">æ—¥å¹£åŒ¯ç‡</label>
        <input type="number" class="form price" id="exchange" v-model.number="exchange" placeholder="è«‹è¼¸å…¥æ—¥å¹£åŒ¯ç‡">
        <label for="price">å•†å“é‡‘é¡</label>
        <input type="number" class="form price" id="price" v-model.number="price" placeholder="è«‹è¼¸å…¥æ—¥å¹£é‡‘é¡">
        <label for="shipping">æ—¥æœ¬å¢ƒå…§é‹è²»</label>
        <input type="number" class="form shipping" id="shipping" v-model.number="shipping" placeholder="è«‹è¼¸å…¥æ—¥æœ¬å¢ƒå…§é‹è²»,ç„¡é‹è²»è«‹å¡«0">
        <label for="num">é ä¼°é‡é‡</label>
        <input type="number" class="form num" id="num" v-model.number="num" placeholder="è«‹è¼¸å…¥é ä¼°é‡é‡(å…¬æ–¤)">
        <!-- <div class="input-group"><input type="checkbox" class="vip" id="vip"><label for="vip" style="margin:0px">æ˜¯å¦ç¬¦åˆé€±å¹´æ…¶æ»¿é¡æŠ˜</label></div> -->
        <button @click="cal">è¨ˆç®—åƒ¹æ ¼</button>
      </div>
      <hr>

      <div class="text"></div>
      <div class="copy"></div>
    </div>

    <script>
    Vue.filter('currency',function(value){
        return value.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,')
    });
    var app = new Vue({
          el:'.wrap',
          data:{
            exchange:0,
            price:0,
            shipping:0,
            num:0,
            totalPrice:0,
            finalPrice:0,
          },
          methods: {
            cal: function () {
              this.totalPrice = Math.round((this.price + this.shipping)* this.exchange)
              this.finalPrice = Math.round((this.totalPrice + this.num * 250 + 60))
              var text = `<p>ğŸ“£å ±åƒ¹å¦‚ä¸‹</br>ğŸ”·å•†å“é‡‘é¡ï¼š`
              if (this.shipping == 0) {
                      text += `<span class="Price">${toCurrency(this.price)}</span>`
                  } else { text += `[<span class="Price">${toCurrency(this.price)}</span> + <span class="Shipping">${toCurrency(this.shipping)}</span>(æ—¥æœ¬å¢ƒå…§é‹è²»)]` }
                  text += ` * ${this.exchange} = <span class="totalPrice">${toCurrency(this.totalPrice)}</span></br>
              ğŸ”·åœ‹éš›é‹è²»ï¼š1å…¬æ–¤250å…ƒ</br>
              ğŸ”·æ‡‰ä»˜é‡‘é¡ï¼š<span class="totalPrice">${toCurrency(this.totalPrice)}</span> + <span class="Num">250*${this.num}</span>(é‡é‡é ä¼°${this.num}kgä»¥å…§) + 60(è¶…å•†é‹è²») = <span class="finalPrice">${toCurrency(this.finalPrice)}</span></p>`


                  $(".text").html(text)
                  $(".copy").html(`<button onClick="CopyTextToClipboard('.text')">é»æ“Šè¤‡è£½</button>`)
                  $(".price").val("")
                  $(".shipping").val("")
                  $(".num").val("")
                  console.log(text)
              },
              CopyTextToClipboard: function (id) {
                var TextRange = document.createRange();
                TextRange.selectNode(document.querySelector(id));
                sel = window.getSelection();
                sel.removeAllRanges();
                sel.addRange(TextRange);
                document.execCommand("copy");
                // alert("è¤‡è£½å®Œæˆï¼")  //æ­¤è¡Œå¯åŠ å¯ä¸åŠ   
              },
              toCurrency:function(num){
                var parts = num.toString().split('.');
                parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                return parts.join('.'); 
              }
            },
        })
    </script>
    
    </body>
</html>
